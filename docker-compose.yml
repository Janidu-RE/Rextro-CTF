version: '3.8'

services:
  # 1. Backend Service
  backend:
    build: ./backend
    container_name: ctf-backend
    restart: always
    ports:
      - "5001:5001"
    environment:
      - PORT=5001
      - NODE_ENV=production
      - JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
      # ðŸ‘‡ PASTE YOUR REAL ATLAS CONNECTION STRING HERE ðŸ‘‡
      - MONGODB_URI=mongodb+srv://janidu:janidu2001@cluster0.zgp4c9w.mongodb.net/CTF?retryWrites=true&w=majority
    networks:
      - ctf-network

  # 2. Frontend Service
  frontend:
    build:
      context: ./admin
      args:
        # ðŸ‘‡ IMPORTANT: If 10-11 PCs are connecting, replace 'localhost' with your computer's LAN IP (e.g., http://192.168.1.50:5001/api)
        - VITE_API_BASE_URL=http://localhost:5001/api
    container_name: ctf-frontend
    restart: always
    ports:
      - "5173:5173"
    depends_on:
      - backend
    networks:
      - ctf-network

networks:
  ctf-network:
    driver: bridge